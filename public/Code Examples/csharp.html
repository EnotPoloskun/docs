
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>C# - SendGrid Documentation - Email Delivery. Simplified.</title>
  <meta name="author" content="SendGrid">

  
  <meta name="description" content="Docs Home Overview	API Reference API Libraries SMTP API Apps (Filters) Categories SMTP API Overview Section Tags Substitution Tags Unique Arguments &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://docs.sendgrid.com/Code Examples/csharp.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/sprites.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="SendGrid Documentation - Email Delivery. Simplified." type="application/atom+xml">
  
  

</head>

<body   >

  <div class="main-container container">  
  <div class="container" id="header-wrap">
	<div class="row" id="header">
		<div id="logo">
			<a href="http://sendgrid.com/blog"><img src="/images/sendgrid-logo.png"/></a>
		</div>
		
		  <form class="pull-right navbar-search" action="http://google.com/search" method="get">
			<input type="hidden" name="q" value="site:docs.sendgrid.com" />
			<input class="search-query span3"name="q" results="0" placeholder="Search"/a>
	      </form>
		
	</div>
	<div class="row menu">
	<ul id="main-menu" class="nav nav-tabs">
		<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
			<a href="/">Docs Home</a>
		</li>
		<li class="menu-item menu-item-type-custom menu-item-object-custom">
			<a href="/API Workshop/index.html">API Workshop</a>
		</li>
		<li class="menu-item menu-item-type-custom menu-item-object-custom">
			<a href="http://sendgrid.com/features.html">Community</a>
		</li>
	</ul>
</div>
</div>

    <div class="row-fluid" id="content">
      
<aside class="sidebar-nav span3">
    <ul class="nav nav-list">
  <ul class="nav nav-list">	 <li class=><a href="/index.html">Docs Home</a></li>	 <li class=><a href="/overview.html">Overview</a></li>	<li class="nav-header"><a href="/API Reference/index.html">API Reference</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/API Reference/libraries.html">API Libraries</a></li>	 	<li class="nav-header"><a href="/API Reference/SMTP API/index.html">SMTP API</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/API Reference/SMTP API/apps.html">Apps (Filters)</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/categories.html">Categories</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/index.html">SMTP API Overview</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/section_tags.html">Section Tags</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/substitution_tags.html">Substitution Tags</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/unique_arguments.html">Unique Arguments</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/API Reference/Webhooks/index.html">Webhooks</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/API Reference/Webhooks/event.html">Event</a></li>	 	 	 <li class=><a href="/API Reference/Webhooks/parse.html">Inbound Parse</a></li>	 	  </ul>	  </ul>	<li class="nav-header"><a href="/API Workshop/index.html">API Workshop</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/API Workshop/index.html">API Workshop</a></li>	  </ul>	<li class="nav-header"><a href="/Apps/index.html">Apps</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Apps/address_whitelisting.html">Address Whitelisting</a></li>	 	 <li class=><a href="/Apps/bcc.html">BCC</a></li>	 	 <li class=><a href="/Apps/bypass_list_management.html">Bypass List Management</a></li>	 	 <li class=><a href="/Apps/click_tracking.html">Click Tracking</a></li>	 	 <li class=><a href="/Apps/dkim.html">DKIM</a></li>	 	 <li class=><a href="/Apps/domain_keys.html">Domain Keys</a></li>	 	 <li class=><a href="/Apps/email_templates.html">Email Templates</a></li>	 	 <li class=><a href="/Apps/event_notification.html">Event Notification</a></li>	 	 <li class=><a href="/Apps/footer.html">Footer</a></li>	 	 <li class=><a href="/Apps/forward_spam.html">Forward Spam</a></li>	 	 <li class=><a href="/Apps/google_analytics.html">Google Analytics</a></li>	 	 <li class=><a href="/Apps/gravatar.html">Gravatar</a></li>	 	 <li class=><a href="/Apps/index.html">Apps Overview</a></li>	 	 <li class=><a href="/Apps/open_tracking.html">Open Tracking</a></li>	 	 <li class=><a href="/Apps/return_path_seedlist.html">Return Path Seedlist</a></li>	 	 <li class=><a href="/Apps/spam_checker.html">Spam Checker</a></li>	 	 <li class=><a href="/Apps/subscription_tracking.html">Subscription Tracking</a></li>	  </ul>	<li class="nav-header"><a href="/Code Examples/index.html">Code Examples</a></li>	 <ul class="nav nav-list">	 	 <li class=active><a href="/Code Examples/csharp.html">C#</a></li>	 	 <li class=><a href="/Code Examples/java.html">Java</a></li>	 	 <li class=><a href="/Code Examples/nodejs.html">Node.js</a></li>	 	 <li class=><a href="/Code Examples/perl.html">Perl</a></li>	 	 <li class=><a href="/Code Examples/php.html">PHP</a></li>	 	 <li class=><a href="/Code Examples/python.html">Python</a></li>	 	 <li class=><a href="/Code Examples/ruby.html">Ruby</a></li>	  </ul>	<li class="nav-header"><a href="/Delivery Metrics/index.html">Delivery Metrics</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Delivery Metrics/alerts.html">Alerts</a></li>	 	 <li class=><a href="/Delivery Metrics/categories.html">Categories</a></li>	 	 <li class=><a href="/Delivery Metrics/email_activity.html">Email Activity</a></li>	 	 <li class=><a href="/Delivery Metrics/email_error_messages.html">Email Error Messages</a></li>	 	 <li class=><a href="/Delivery Metrics/email_reports.html">Email Reports</a></li>	 	 <li class=><a href="/Delivery Metrics/index.html">Delivery Metrics</a></li>	  </ul>	<li class="nav-header"><a href="/Integrate/index.html">Integrate</a></li>	 <ul class="nav nav-list">	 	<li class="nav-header"><a href="/Integrate/Frameworks/index.html">Frameworks</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Frameworks/cakephp.html">CakePHP</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/codeigniter.html">CodeIgniter</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/django.html">Django</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/nodejs.html">Node.js</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/rubyonrails.html">Ruby on Rails</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/symfony.html">Symfony</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/Integrate/Mail Clients/index.html">Mail Clients</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Mail Clients/applemail.html">Apple Mail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/gmail.html">Gmail / Google Apps</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/outlook.html">Outlook 2007</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/thunderbird.html">Thunderbird</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/Integrate/Mail Servers/index.html">Mail Servers</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Mail Servers/exim.html">Exim</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/iis75.html">Microsoft IIS 7.5</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/postfix.html">Postfix</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/qmail.html">Qmail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/sendmail.html">Sendmail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/ssmtp.html">ssmtp</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/Integrate/Open Source Apps/index.html">Open Source Apps</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Open Source Apps/drupal.html">Drupal</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/joomla.html">Joomla</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/magento.html">Magento</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/phpbb.html">phpBB</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/wordpress.html">WordPress</a></li>	 	  </ul>	  </ul> </ul>
</ul>
<br/>

</aside>



<article role="article" class="span9">

  
  <header class="page-header">
	<ul class="breadcrumb"><li><a href="/Code Examples/">Code Examples</a><span class="divider">/</span></li><li>C#</li></ul>
    <h1 class="entry-title">C#</h1>
    
  </header>
  
  <p>To use SendGrid in your C# project, you can either <a href="https://github.com/sendgrid/sendgrid-csharp.git">download the SendGrid C# .NET libraries directly from our Github repository</a> or, if you have the NuGet package manager installed, you can grab them automatically.
</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PM&gt; Install-Package Sendgrid </span></code></pre></td></tr></table></div></figure>
<p>
Once you have the SendGrid libraries properly referenced in your project, you can include calls to them in your code. This first example shows the basic structure of the code required to call the SendGrid libraries and send email, as can be found in the program.cs file in the examples directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Net.Mail</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">SendGridMail</span><span class="p">;</span>
</span><span class='line'><span class="k">using</span> <span class="nn">SendGridMail.Transport</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="nn">Example</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">class</span> <span class="nc">Program</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// this code is used for the SMTPAPI examples</span>
</span><span class='line'>        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">username</span> <span class="p">=</span> <span class="s">&quot;sgrid_username&quot;</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="s">&quot;sgrid_password&quot;</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">var</span> <span class="k">from</span> <span class="p">=</span> <span class="s">&quot;bar@domain.com&quot;</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">to</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span>
</span><span class='line'>                         <span class="p">{</span>
</span><span class='line'>                             <span class="s">&quot;foo@domain.com&quot;</span><span class="p">,</span>
</span><span class='line'>                             <span class="s">&quot;raz@domain.com&quot;</span>
</span><span class='line'>                         <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//initialize the SMTPAPI example class</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">smtpapi</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SMTPAPI</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="n">to</span><span class="p">);</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">restapi</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WEBAPI</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="n">to</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//use this section to test out our Web and SMTP examples!</span>
</span><span class='line'>            <span class="n">smtpapi</span><span class="p">.</span><span class="n">SimpleHTMLEmail</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Done!&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>In order to send a simple HTML email using the SendGrid SMTP API, use this code sample:
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">SimpleHTMLEmail</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="c1">//create a new message object</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">message</span> <span class="p">=</span> <span class="n">SendGrid</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message recipients</span>
</span><span class='line'>            <span class="k">foreach</span><span class="p">(</span><span class="kt">string</span> <span class="n">recipient</span> <span class="k">in</span> <span class="n">_to</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">message</span><span class="p">.</span><span class="n">AddTo</span><span class="p">(</span><span class="n">recipient</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the sender</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">From</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MailAddress</span><span class="p">(</span><span class="n">_from</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message body</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">Html</span> <span class="p">=</span> <span class="s">&quot;&lt;html&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;World&lt;/p&gt;&lt;/html&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message subject</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">Subject</span> <span class="p">=</span> <span class="s">&quot;Hello World HTML Test&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//create an instance of the SMTP transport mechanism</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">transportInstance</span> <span class="p">=</span> <span class="n">SMTP</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">(</span><span class="k">new</span> <span class="n">NetworkCredential</span><span class="p">(</span><span class="n">_username</span><span class="p">,</span> <span class="n">_password</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//send the mail</span>
</span><span class='line'>            <span class="n">transportInstance</span><span class="p">.</span><span class="n">Deliver</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p><span class="label label-info">Info</span> There are two calls you can make to the AddTo function. One injects addresses into the standard MIME TO: field, and that&#8217;s done (as in the above code sample) like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">message</span><span class="p">.</span><span class="n">AddTo</span><span class="p">(</span><span class="n">sampleListName</span><span class="p">(){</span><span class="s">&quot;foo@bar.com&quot;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>

<p>Using the X-SMTPAPI header makes this process a little cleaner and causes the message to appear as if it were sent directly to the recipient, as opposed to lots and lots of recipients. In order to inject addresses into into the X-SMTPAPI header, make the call like so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">message</span><span class="p">.</span><span class="n">Header</span><span class="p">.</span><span class="n">AddTo</span><span class="p">(</span><span class="n">sampleListName</span><span class="p">(){</span><span class="s">&quot;foo@bar.com&quot;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>

<p>If you would prefer to send a simple HTML message using the SendGrid Web API, use this code:
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">SimpleHTMLEmail</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="c1">//create a new message object</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">message</span> <span class="p">=</span> <span class="n">SendGrid</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message recipients</span>
</span><span class='line'>            <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">recipient</span> <span class="k">in</span> <span class="n">_to</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">message</span><span class="p">.</span><span class="n">AddTo</span><span class="p">(</span><span class="n">recipient</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the sender</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">From</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MailAddress</span><span class="p">(</span><span class="n">_from</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message body</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">Html</span> <span class="p">=</span> <span class="s">&quot;&lt;html&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;World&lt;/p&gt;&lt;/html&gt;&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message subject</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">Subject</span> <span class="p">=</span> <span class="s">&quot;Hello World HTML Test&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//create an instance of the Web transport mechanism</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">transportInstance</span> <span class="p">=</span> <span class="n">Web</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">(</span><span class="k">new</span> <span class="n">NetworkCredential</span><span class="p">(</span><span class="n">_username</span><span class="p">,</span> <span class="n">_password</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//send the mail</span>
</span><span class='line'>            <span class="n">transportInstance</span><span class="p">.</span><span class="n">Deliver</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>The following is a code sample that allows you to add substitution values to your messages. This is a powerful feature that makes it significantly easier to generate personalized email messages:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">AddSubstitutionValues</span><span class="p">()</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="c1">//create a new message object</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">message</span> <span class="p">=</span> <span class="n">SendGrid</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message recipients</span>
</span><span class='line'>            <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">recipient</span> <span class="k">in</span> <span class="n">_to</span><span class="p">)</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="n">message</span><span class="p">.</span><span class="n">AddTo</span><span class="p">(</span><span class="n">recipient</span><span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the sender</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">From</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MailAddress</span><span class="p">(</span><span class="n">_from</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message body</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">&quot;Hi %name%! Pleased to meet you!&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//set the message subject</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">Subject</span> <span class="p">=</span> <span class="s">&quot;Testing Substitution Values&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//This replacement key must exist in the message body</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">replacementKey</span> <span class="p">=</span> <span class="s">&quot;%name%&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//There should be one value for each recipient in the To list</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">substitutionValues</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;</span> <span class="p">{</span><span class="s">&quot;Mr Foo&quot;</span><span class="p">,</span> <span class="s">&quot;Mrs Raz&quot;</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">AddSubVal</span><span class="p">(</span><span class="n">replacementKey</span><span class="p">,</span> <span class="n">substitutionValues</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//create an instance of the SMTP transport mechanism</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">transportInstance</span> <span class="p">=</span> <span class="n">SMTP</span><span class="p">.</span><span class="n">GetInstance</span><span class="p">(</span><span class="k">new</span> <span class="n">NetworkCredential</span><span class="p">(</span><span class="n">_username</span><span class="p">,</span> <span class="n">_password</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//enable bypass list management</span>
</span><span class='line'>            <span class="n">message</span><span class="p">.</span><span class="n">EnableBypassListManagement</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">//send the mail</span>
</span><span class='line'>            <span class="n">transportInstance</span><span class="p">.</span><span class="n">Deliver</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>
  
    <footer>
      
      
        <div class="sharing">
  
  
  
</div>

      
      
    </footer>
  
</article>


    </div>
  </div>
	<div id="footer">
	<div class="container-fluid footer-links">
	<div class="container">
		<div class="row">
			<div class="span2">
				<h4>Sales</h4>
				<a href="http://sendgrid.com/pricing/">Pricing</a><br/>
				<a href="http://sendgrid.com/features/">Features</a>
			</div>
			<div class="span2">
				<h4>Support</h4>
				<a href="http://support.sendgrid.com/">Contact Support</a><br/>
				<a href="http://docs.sendgrid.com/">Documentation</a><br/>
				<a href="http://sendgrid.com/contact/reportSpam">Report Spam</a>
			</div>
			<div class="span2">
				<h4>Community</h4>
				<a href="http://twitter.com/sendgrid/">Twitter</a><br/>
				<a href="http://community.sendgrid.com/">Forum</a>
			</div>
			<div class="span2">
				<h4>Company</h4>
				<a href="http://http://sendgrid.com/about.html">About</a><br/>
				<a href="http://sendgrid.com/team.html">Our Team</a><br/>
				<a href="http://sendgrid.com/jobs.html">Jobs</a><br/>
				<a href="http://sendgrid.com/press.html">Press</a><br/>
				<a href="http://sendgrid.com/contact.html">Contact Us</a>
			</div>
			<div class="span2">
				<h4>Connect With Us!</h4>
				<a href="http://blog.sendgrid.com/feed/"><img alt="RSS" title="Feed" src="/images/rss.gif"></a> 
		          <a href="http://twitter.com/SendGrid"><img alt="Twitter" title="Twitter" src="/images/twitter.gif"></a> 
		          <a href="http://www.facebook.com/SendGrid"><img alt="Facebook" title="Facebook" src="/images/facebook.gif"></a>

			</div>
		</div>
	</div>
	</div>

	<footer id="bottom-footer">
	<div class="container">
		<div class="row">
			<div class="span5">
	        	<p>&copy; SendGrid 2012</p>
			</div>

			<div class="span7">
				<a href="http://sendgrid.com/tos.html">Terms of Service</a>

				<a href="http://sendgrid.com/tos.html">Email Policy</a>

				<a href="http://sendgrid.com/tos.html">Privacy Policy</a>

				<p class="pull-right"><a href="#">Back to top</a></p>
			</div>
		</div>
	</div> <!-- /container -->
	</footer>
</div>

	<!-- 







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




-->
</body>
</html>
