
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Microsoft IIS 7.5 - SendGrid Documentation - Email Delivery. Simplified.</title>
  <meta name="author" content="SendGrid">

  
  <meta name="description" content="Docs Home Overview API Reference API Libraries SMTP API Apps (Filters) Categories SMTP API Overview Section Tags Substitution Tags Unique Arguments &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://docs.sendgrid.com/Integrate/Mail Servers/iis75.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/sprites.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="SendGrid Documentation - Email Delivery. Simplified." type="application/atom+xml">
  
  

</head>

<body   >

  <div class="main-container container">  
  <div class="container" id="header-wrap">
	<div class="row" id="header">
		<div id="logo">
			<a href="http://sendgrid.com/blog"><img src="/images/sendgrid-logo.png"/></a>
		</div>
		
		  <form class="pull-right navbar-search" action="http://google.com/search" method="get">
			<input type="hidden" name="q" value="site:docs.sendgrid.com" />
			<input class="search-query span3"name="q" results="0" placeholder="Search"/a>
	      </form>
		
	</div>
	


<div class="row menu">
	<ul id="main-menu" class="nav nav-tabs">
		<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
			<a href="/">Docs Home</a>
		</li>
		<li class="menu-item menu-item-type-custom menu-item-object-custom">
			<a href="/API Workshop/index.html">API Workshop</a>
		</li>
		<li class="menu-item menu-item-type-custom menu-item-object-custom">
			<a href="http://sendgrid.com/features.html">Community</a>
		</li>
	</ul>
</div>


</div>

    <div class="row-fluid" id="content">
      
<aside class="sidebar-nav span3">
    <ul class="nav nav-list">
  <ul class="nav nav-list">	 <li class=><a href="/index.html">Docs Home</a></li>	 <li class=><a href="/overview.html">Overview</a></li>	 <li>API Reference</li>	 <ul class="nav nav-list">	 	 <li class=><a href="/API Reference/libraries.html">API Libraries</a></li>	 	 <li>SMTP API</li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/API Reference/SMTP API/apps.html">Apps (Filters)</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/categories.html">Categories</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/overview.html">SMTP API Overview</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/section_tags.html">Section Tags</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/substitution_tags.html">Substitution Tags</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/unique_arguments.html">Unique Arguments</a></li>	 	  </ul>	 	 <li>Webhooks</li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/API Reference/Webhooks/event.html">Event</a></li>	 	 	 <li class=><a href="/API Reference/Webhooks/parse.html">Inbound Parse</a></li>	 	  </ul>	  </ul>	 <li>API Workshop</li>	 <ul class="nav nav-list">	 	 <li class=><a href="/API Workshop/index.html">API Workshop</a></li>	  </ul>	 <li>Apps</li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Apps/address_whitelisting.html">Address Whitelisting</a></li>	 	 <li class=><a href="/Apps/bcc.html">BCC</a></li>	 	 <li class=><a href="/Apps/bypass_list_management.html">Bypass List Management</a></li>	 	 <li class=><a href="/Apps/click_tracking.html">Click Tracking</a></li>	 	 <li class=><a href="/Apps/dkim.html">DKIM</a></li>	 	 <li class=><a href="/Apps/domain_keys.html">Domain Keys</a></li>	 	 <li class=><a href="/Apps/email_templates.html">Email Templates</a></li>	 	 <li class=><a href="/Apps/event_notification.html">Event Notification</a></li>	 	 <li class=><a href="/Apps/footer.html">Footer</a></li>	 	 <li class=><a href="/Apps/forward_spam.html">Forward Spam</a></li>	 	 <li class=><a href="/Apps/google_analytics.html">Google Analytics</a></li>	 	 <li class=><a href="/Apps/gravatar.html">Gravatar</a></li>	 	 <li class=><a href="/Apps/open_tracking.html">Open Tracking</a></li>	 	 <li class=><a href="/Apps/overview.html">Apps Overview</a></li>	 	 <li class=><a href="/Apps/return_path_seedlist.html">Return Path Seedlist</a></li>	 	 <li class=><a href="/Apps/spam_checker.html">Spam Checker</a></li>	 	 <li class=><a href="/Apps/subscription_tracking.html">Subscription Tracking</a></li>	  </ul>	 <li>Code Examples</li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Code Examples/csharp.html">C#</a></li>	 	 <li class=><a href="/Code Examples/java.html">Java</a></li>	 	 <li class=><a href="/Code Examples/nodejs.html">Node.js</a></li>	 	 <li class=><a href="/Code Examples/perl.html">Perl</a></li>	 	 <li class=><a href="/Code Examples/php.html">PHP</a></li>	 	 <li class=><a href="/Code Examples/python.html">Python</a></li>	 	 <li class=><a href="/Code Examples/ruby.html">Ruby</a></li>	  </ul>	 <li>Delivery Metrics</li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Delivery Metrics/index.html">Delivery Metrics</a></li>	  </ul>	 <li>Integrate</li>	 <ul class="nav nav-list">	 	 <li>Frameworks</li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Frameworks/cakephp.html">CakePHP</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/codeigniter.html">CodeIgniter</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/django.html">Django</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/nodejs.html">Node.js</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/rubyonrails.html">Ruby on Rails</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/symfony.html">Symfony</a></li>	 	  </ul>	 	 <li>Mail Clients</li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Mail Clients/applemail.html">Apple Mail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/gmail.html">Gmail / Google Apps</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/outlook.html">Outlook 2007</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/thunderbird.html">Thunderbird</a></li>	 	  </ul>	 	 <li>Mail Servers</li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Mail Servers/exim.html">Exim</a></li>	 	 	 <li class=active><a href="/Integrate/Mail Servers/iis75.html">Microsoft IIS 7.5</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/postfix.html">Postfix</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/qmail.html">Qmail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/sendmail.html">Sendmail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/ssmtp.html">ssmtp</a></li>	 	  </ul>	 	 <li>Open Source Apps</li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Open Source Apps/drupal.html">Drupal</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/joomla.html">Joomla</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/magento.html">Magento</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/phpbb.html">phpBB</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/wordpress.html">WordPress</a></li>	 	  </ul>	  </ul> </ul>
</ul>
<br/>

</aside>



<article role="article" class="span9">

  
  <header class="page-header">
    <h1 class="entry-title">Microsoft IIS 7.5</h1>
    
  </header>
  
  <span class="label label-info">Info</span> This document was written using Windows Server 2008 R2 running IIS version 7.5 and ASP.NET scripting technology for sending email. Only basic authentication is supported in this document. If you require SSL/TLS, you will need to configure those elements separately.</blockquote>

<h2>IIS 7.5 Configuration</h2>

<p>Before you get going, you’ll need to set up IIS in order to support SendGrid integration. This tutorial assumes that you have set up a working site and that the root directory tests as valid.</p>

<ol>
	<li>Open IIS 7.0/7.5 Manager in Windows</li>
	<li>Click on your site (see image below, noting that your configuration will look different), and the main configuration options page will be displayed to the right</li>
	<li>Double-click on the “SMTP E-mail” under the ASP.NET section (to get the below screen)</li>
	<li>In the email address field: type the email address that will be the “sender”</li>
	<li>Click on the “Deliver e-mail to SMTP server” radio button if not already enabled</li>
	<li>In the SMTP Server field: type localhost</li>
	<li>In the Port field: type 25</li>
	<li>In Authentication Settings click the “Not required” option.</li>
	<li>On the right side “Actions” pane: click Apply</li>
</ol>

<center><img src="/images/iis_mgr_site.png" width="593" height="489"></center>

<span class="label label-info">Info</span> If you want to configure additional security to the localhost IIS 6.0 server you would set it here and match the same authentication in the IIS 6.0 GUI.
</blockquote>

<h2>Enable SMTP Service:</h2>

<ol class="regular">
	<li>Go to Start > All Programs > Administrative Tools > Server Manager</li>
	<li>Click on the Features item in the navigation pane</li>
	<li>Click the Add Features link to start the wizard</li>
	<li>Scroll down the list to the SMTP Server, and check the box. The Required Role Services dialog will appear, listing all of the dependencies that the SMTP server depends on to operate. Click Add Require Role Services.</li> 
	<li>Click Next twice</li>
	<li>Review the list of available IIS Role Services and check any that you would like to add</li>
	<li>Click Next then click Install</li>
</ol>

<p>Once the SMTP Server service is installed, the IIS 6.0 virtual server technology is activated, and the IIS 6.0 administration snap-in will now be active.</p>

<h2>Configure IIS 6.0 to Relay Outbound Email to SendGrid</h2>

<ol class="regular">
	<li>Go to Start > All Programs > Administrative Tools > IIS 6.0 Manager</li>
	<li>Right click on the SMTP Virtual Server #1 and select the Properties option</li>
	<li>Click the box to enable logging section to assist you in configuring the server</li>
	<li>Click on Properties and check the box to activate Use Local Time For File Naming And Rollover option</li>
	<li>Click on the Advanced tab and check the following items: Date, Time, Client IP Address, User Name, Service Name, Server Name, Server IP Address, Server Port, Method, Protocol Status, Bytes Sent, Protocol Version, and Host.</li>
	<li>Click OK</li>
	<li>Click on the Access tab the click the Relay button in the Relay Restrictions section</li>
	<li>Click Add, enter 127.0.0.1, and click OK. The IP will appear in the list with Access Granted</li>
	<li>Click OK Only The List Below radio button and enter 127.0.0.1 in the IP address field.</li>
	<li>Click on OK to return to the Access tab as shown in the previous screenshots.</li>
	<li>Select the Delivery tab and click the Outbound Security button</li>
	<li>Click on Basic Authentication where the Username will be your SendGrid.com username and the password will be your SendGrid.com password</li>
	<li>Click OK</li>
	<li>Click the Advanced button</li>
	<li>In the Smart host field: enter smtp.sendgrid.net</li>
	<li>Click on OK twice and you can close the IIS 6.0 admin MMC</li>
</ol>

<h2>Testing Your New Configuration</h2>

<p>First, let&#8217;s test using Telnet. Open up a telnet client within Windows. You do that in the Command Prompt by entering the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>telnet localhost 25</span></code></pre></td></tr></table></div></figure>

<p>Now, with telnet running, enter the following commands just as you see them, pressing ENTER for each new line (if configured correctly, the server won&#8217;t do anything until you enter the period):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>EHLO yourdomain.com
</span><span class='line'>MAIL FROM: test@yourdomain.com
</span><span class='line'>RCPT TO: recipient@anotherdomain.com
</span><span class='line'>DATA
</span><span class='line'>This is a test email for SendGrid operations.
</span><span class='line'>.</span></code></pre></td></tr></table></div></figure>
<p>The <strong>EHLO</strong> command with your domain inserted tells the mail server which domain it will be sending from. The <strong>MAIL FROM:</strong> command is a standard MIME entry for that inserts the email address of the sender. The <strong>RCPT TO:</strong> command tells the server to which address to send the message. The <strong>DATA</strong> command tells the server that the next incoming information is the body of the message. Finally, after the data is entered, the period (.) tells the server you are done. When you press Enter, it will send the message. It&#8217;s quite nice to have servers to handle all this mess, isn&#8217;t it!</p>

<p>If these manually entered commands work, then you should have the following success code returned:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>250….Queued mail for delivery</span></code></pre></td></tr></table></div></figure>
<p>
You can also test using the logging feature we had you activate earlier. You can view the logs by navigating to and opening the IIS 6.0 7.5 log files with a text editor. It will probably be under the C:\Windows\System32\LogFiles directory unless you changed the log file location during installation.</p>

<p>Notice, highlighted in blue below, that the server sent an email and that it went through various OutboundConnectionCommand and Outbound ConnectionResponse steps.  These along with the information of the various stages of EHLO, AUTH, MAIL, RCPT, DATA and quit that the email was sent successfully.</p>
 
<p>Finally, you can confirm that your configuration is working by logging into our site. Login into our web portal using your SendGrid credentials. On the main Dashboard tab you will see a list of messages that were recently sent through our service. This number should increment by one each time you either use telnet to send an email or you use a ASP.NET test script.</p>
  
    <footer>
      
      
        <div class="sharing">
  
  
  
</div>

      
      
    </footer>
  
</article>


    </div>
  </div>
	<div id="footer">
	<div class="container-fluid footer-links">
	<div class="container">
		<div class="row">
			<div class="span2">
				<h4>Sales</h4>
				<a href="http://sendgrid.com/pricing/">Pricing</a><br/>
				<a href="http://sendgrid.com/features/">Features</a>
			</div>
			<div class="span2">
				<h4>Support</h4>
				<a href="http://support.sendgrid.com/">Contact Support</a><br/>
				<a href="http://docs.sendgrid.com/">Documentation</a><br/>
				<a href="http://sendgrid.com/contact/reportSpam">Report Spam</a>
			</div>
			<div class="span2">
				<h4>Community</h4>
				<a href="http://twitter.com/sendgrid/">Twitter</a><br/>
				<a href="http://community.sendgrid.com/">Forum</a>
			</div>
			<div class="span2">
				<h4>Company</h4>
				<a href="http://http://sendgrid.com/about.html">About</a><br/>
				<a href="http://sendgrid.com/team.html">Our Team</a><br/>
				<a href="http://sendgrid.com/jobs.html">Jobs</a><br/>
				<a href="http://sendgrid.com/press.html">Press</a><br/>
				<a href="http://sendgrid.com/contact.html">Contact Us</a>
			</div>
			<div class="span2">
				<h4>Connect With Us!</h4>
				<a href="http://blog.sendgrid.com/feed/"><img alt="RSS" title="Feed" src="/images/rss.gif"></a> 
		          <a href="http://twitter.com/SendGrid"><img alt="Twitter" title="Twitter" src="/images/twitter.gif"></a> 
		          <a href="http://www.facebook.com/SendGrid"><img alt="Facebook" title="Facebook" src="/images/facebook.gif"></a>

			</div>
		</div>
	</div>
	</div>

	<footer id="bottom-footer">
	<div class="container">
		<div class="row">
			<div class="span5">
	        	<p>&copy; SendGrid 2012</p>
			</div>

			<div class="span7">
				<a href="http://sendgrid.com/tos.html">Terms of Service</a>

				<a href="http://sendgrid.com/tos.html">Email Policy</a>

				<a href="http://sendgrid.com/tos.html">Privacy Policy</a>

				<p class="pull-right"><a href="#">Back to top</a></p>
			</div>
		</div>
	</div> <!-- /container -->
	</footer>
</div>

	<!-- 







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




-->
</body>
</html>
