
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>SMTP API Overview - SendGrid Documentation - Email Delivery. Simplified.</title>
  <meta name="author" content="SendGrid">

  
  <meta name="description" content="Docs Home Overview	API Reference API Libraries API Reference/SMTP API Apps (Filters) Categories SMTP API Overview Section Tags Substitution Tags &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://docs.sendgrid.com/API Reference/SMTP API">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/sprites.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="SendGrid Documentation - Email Delivery. Simplified." type="application/atom+xml">
  
  

</head>

<body   >

  <div class="main-container container">  
  <div class="container" id="header-wrap">
	<div class="row" id="header">
		<div id="logo">
			<a href="http://sendgrid.com/blog"><img src="/images/sendgrid-logo.png"/></a>
		</div>
		
		  <form class="pull-right navbar-search" action="http://google.com/search" method="get">
			<input type="hidden" name="q" value="site:docs.sendgrid.com" />
			<input class="search-query span3"name="q" results="0" placeholder="Search"/a>
	      </form>
		
	</div>
	<div class="row menu">
	<ul id="main-menu" class="nav nav-tabs">
		<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
			<a href="/">Docs Home</a>
		</li>
		<li class="menu-item menu-item-type-custom menu-item-object-custom">
			<a href="/API Workshop/index.html">API Workshop</a>
		</li>
		<li class="menu-item menu-item-type-custom menu-item-object-custom">
			<a href="http://sendgrid.com/features.html">Community</a>
		</li>
	</ul>
</div>
</div>

    <div class="row-fluid" id="content">
      
<aside class="sidebar-nav span3">
    <ul class="nav nav-list">
  <ul class="nav nav-list">	 <li class=><a href="/index.html">Docs Home</a></li>	 <li class=><a href="/overview.html">Overview</a></li>	<li class="nav-header"><a href="/API Reference/index.html">API Reference</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/API Reference/libraries.html">API Libraries</a></li>	 	<li class="nav-header"><a href="/API Reference/SMTP API/index.html">API Reference/SMTP API</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/API Reference/SMTP API/apps.html">Apps (Filters)</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/categories.html">Categories</a></li>	 	 	 <li class=active><a href="/API Reference/SMTP API/index.html">SMTP API Overview</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/section_tags.html">Section Tags</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/substitution_tags.html">Substitution Tags</a></li>	 	 	 <li class=><a href="/API Reference/SMTP API/unique_arguments.html">Unique Arguments</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/API Reference/Webhooks/index.html">API Reference/Webhooks</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/API Reference/Webhooks/event.html">Event</a></li>	 	 	 <li class=><a href="/API Reference/Webhooks/parse.html">Inbound Parse</a></li>	 	  </ul>	  </ul>	<li class="nav-header"><a href="/API Workshop/index.html">API Workshop</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/API Workshop/index.html">API Workshop</a></li>	  </ul>	<li class="nav-header"><a href="/Apps/index.html">Apps</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Apps/address_whitelisting.html">Address Whitelisting</a></li>	 	 <li class=><a href="/Apps/bcc.html">BCC</a></li>	 	 <li class=><a href="/Apps/bypass_list_management.html">Bypass List Management</a></li>	 	 <li class=><a href="/Apps/click_tracking.html">Click Tracking</a></li>	 	 <li class=><a href="/Apps/dkim.html">DKIM</a></li>	 	 <li class=><a href="/Apps/domain_keys.html">Domain Keys</a></li>	 	 <li class=><a href="/Apps/email_templates.html">Email Templates</a></li>	 	 <li class=><a href="/Apps/event_notification.html">Event Notification</a></li>	 	 <li class=><a href="/Apps/footer.html">Footer</a></li>	 	 <li class=><a href="/Apps/forward_spam.html">Forward Spam</a></li>	 	 <li class=><a href="/Apps/google_analytics.html">Google Analytics</a></li>	 	 <li class=><a href="/Apps/gravatar.html">Gravatar</a></li>	 	 <li class=><a href="/Apps/index.html">Apps Overview</a></li>	 	 <li class=><a href="/Apps/open_tracking.html">Open Tracking</a></li>	 	 <li class=><a href="/Apps/return_path_seedlist.html">Return Path Seedlist</a></li>	 	 <li class=><a href="/Apps/spam_checker.html">Spam Checker</a></li>	 	 <li class=><a href="/Apps/subscription_tracking.html">Subscription Tracking</a></li>	  </ul>	<li class="nav-header"><a href="/Code Examples/index.html">Code Examples</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Code Examples/csharp.html">C#</a></li>	 	 <li class=><a href="/Code Examples/java.html">Java</a></li>	 	 <li class=><a href="/Code Examples/nodejs.html">Node.js</a></li>	 	 <li class=><a href="/Code Examples/perl.html">Perl</a></li>	 	 <li class=><a href="/Code Examples/php.html">PHP</a></li>	 	 <li class=><a href="/Code Examples/python.html">Python</a></li>	 	 <li class=><a href="/Code Examples/ruby.html">Ruby</a></li>	  </ul>	<li class="nav-header"><a href="/Delivery Metrics/index.html">Delivery Metrics</a></li>	 <ul class="nav nav-list">	 	 <li class=><a href="/Delivery Metrics/alerts.html">Alerts</a></li>	 	 <li class=><a href="/Delivery Metrics/categories.html">Categories</a></li>	 	 <li class=><a href="/Delivery Metrics/email_activity.html">Email Activity</a></li>	 	 <li class=><a href="/Delivery Metrics/email_error_messages.html">Email Error Messages</a></li>	 	 <li class=><a href="/Delivery Metrics/email_reports.html">Email Reports</a></li>	 	 <li class=><a href="/Delivery Metrics/index.html">Delivery Metrics</a></li>	  </ul>	<li class="nav-header"><a href="/Integrate/index.html">Integrate</a></li>	 <ul class="nav nav-list">	 	<li class="nav-header"><a href="/Integrate/Frameworks/index.html">Integrate/Frameworks</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Frameworks/cakephp.html">CakePHP</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/codeigniter.html">CodeIgniter</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/django.html">Django</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/nodejs.html">Node.js</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/rubyonrails.html">Ruby on Rails</a></li>	 	 	 <li class=><a href="/Integrate/Frameworks/symfony.html">Symfony</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/Integrate/Mail Clients/index.html">Integrate/Mail Clients</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Mail Clients/applemail.html">Apple Mail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/gmail.html">Gmail / Google Apps</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/outlook.html">Outlook 2007</a></li>	 	 	 <li class=><a href="/Integrate/Mail Clients/thunderbird.html">Thunderbird</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/Integrate/Mail Servers/index.html">Integrate/Mail Servers</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Mail Servers/exim.html">Exim</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/iis75.html">Microsoft IIS 7.5</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/postfix.html">Postfix</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/qmail.html">Qmail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/sendmail.html">Sendmail</a></li>	 	 	 <li class=><a href="/Integrate/Mail Servers/ssmtp.html">ssmtp</a></li>	 	  </ul>	 	<li class="nav-header"><a href="/Integrate/Open Source Apps/index.html">Integrate/Open Source Apps</a></li>	 	 <ul class="nav nav-list">	 	 	 <li class=><a href="/Integrate/Open Source Apps/drupal.html">Drupal</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/joomla.html">Joomla</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/magento.html">Magento</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/phpbb.html">phpBB</a></li>	 	 	 <li class=><a href="/Integrate/Open Source Apps/wordpress.html">WordPress</a></li>	 	  </ul>	  </ul> </ul>
</ul>
<br/>

</aside>



<article role="article" class="span9">

  
  <header class="page-header">
    <h1 class="entry-title">SMTP API Overview</h1>
    
  </header>
  
  <p>SendGrid&#8217;s SMTP API allows developers to specify custom handling instructions for e-mail. This is accomplished through a header, X-SMTPAPI, that is inserted into the message. The header is a JSON encoded list of instructions and options for that email. An example header looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">X</span><span class="o">-</span><span class="nx">SMTPAPI</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;category&quot;</span> <span class="o">:</span> <span class="s2">&quot;newuser&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>In this case, the header is telling the processing routine to assign this email the <a href="/documentation/delivery-metrics/categories/">category</a> of &#8220;newuser&#8221;.</p>

<h2>The X-SMTPAPI Header</h2>

<p>The X-SMTPAPI header is a JSON-encoded associative array consisting of several sections, below are examples of JSON strings using each section. This header can be added to any SMTP message sent to SendGrid and the instructions in the header will be interpreted and applied to that message&#8217;s transcation.</p>

<p>
	To: An array of addresses to send the message to.
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;to&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Ben Golden &lt;ben@sendgrid.com&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe Scharf &lt;joe@sendgrid.com&gt;&quot;</span><span class="p">]}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
	<a href="/documentation/api/smtp-api/developers-guide/substitution-tags/">Substitution</a>: An associative array of substitution tags, where each tag is associated with a list of replacement text for the tag in the body text. Each Substitution value corresponds to an email in the &#8220;To&#8221; section of the JSON string.
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;sub&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;%name%&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Ben&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">],</span> <span class="s2">&quot;%role%&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;%sellerSection%&quot;</span><span class="p">,</span> <span class="s2">&quot;%buyerSection%&quot;</span><span class="p">]}}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
	<a href="/documentation/api/smtp-api/developers-guide/section-tags/">Section</a>: Sections can be used to simplify substitution values that are common to many recipients. This is an associative array of sections that can be used in substitution values.
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;section&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;%sellerSection%&quot;</span><span class="o">:</span> <span class="s2">&quot;Seller information for: %name%&quot;</span><span class="p">,</span> <span class="s2">&quot;%buyerSection%&quot;</span><span class="o">:</span> <span class="s2">&quot;Buyer information for: %name%&quot;</span><span class="p">}}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
	<a href="/documentation/delivery-metrics/categories/">Category</a>: Associates the category of email this should be logged as. You may insert up to 10 categories as an array, these categories are not predefined.
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;category&quot;</span><span class="o">:</span> <span class="p">[</span><span class="err">“</span><span class="nx">category1</span><span class="err">”</span><span class="p">,</span><span class="err">”</span><span class="nx">category2</span><span class="err">”</span><span class="p">]}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
	<a href="/documentation/api/smtp-api/developers-guide/unique-arguments/">Unique Arguments</a>: An associative array of arguments and their values to be applied to all emails sent in this SMTP API transaction.
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;unique_args&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;orderNumber&quot;</span><span class="o">:</span> <span class="s2">&quot;12345&quot;</span><span class="p">,</span> <span class="s2">&quot;eventID&quot;</span><span class="o">:</span> <span class="s2">&quot;6789&quot;</span><span class="p">}}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
	<a href="/documentation/api/smtp-api/filter-settings/">Apps</a>: An associative array of filters and their settings, used to override filter settings already setup for your account. Settings are an associative array of the setting names and their values.
</p>
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;filters&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;footer&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;settings&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;enable&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;text/plain&quot;</span><span class="o">:</span> <span class="s2">&quot;Thank you for</span>
</span><span class='line'><span class="s2">your business&quot;</span><span class="p">}}}}</span>
</span></code></pre></td></tr></table></div></figure>

All of the above examples can then be combined into one larger JSON string placed in a header named X-SMTPAPI, and would look like this:

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">X</span><span class="o">-</span><span class="nx">SMTPAPI</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;to&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>        <span class="s2">&quot;ben@sendgrid.com&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;joe@sendgrid.com&quot;</span>
</span><span class='line'>    <span class="p">],</span>
</span><span class='line'>    <span class="s2">&quot;sub&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;%name%&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s2">&quot;Ben&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="s2">&quot;Joe&quot;</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>        <span class="s2">&quot;%role%&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s2">&quot;%sellerSection%&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="s2">&quot;%buyerSection%&quot;</span>
</span><span class='line'>        <span class="p">]</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="s2">&quot;section&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;%sellerSection%&quot;</span><span class="o">:</span> <span class="s2">&quot;Seller information for: %name%&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;%buyerSection%&quot;</span><span class="o">:</span> <span class="s2">&quot;Buyer information for: %name%&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="s2">&quot;category&quot;</span><span class="o">:</span> <span class="s2">&quot;Orders&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;unique_args&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;orderNumber&quot;</span><span class="o">:</span> <span class="s2">&quot;12345&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;eventID&quot;</span><span class="o">:</span> <span class="s2">&quot;6789&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="s2">&quot;filters&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;footer&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="s2">&quot;settings&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>                <span class="s2">&quot;enable&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>                <span class="s2">&quot;text/plain&quot;</span><span class="o">:</span> <span class="s2">&quot;Thank you for your business&quot;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>The above example is formatted for readability. Headers must be wrapped to keep the line length under 72. By RFC 821 no line can be longer than 1,000, so if you are going to generate this string yourself it is a good idea to make sure that you wrap it.</p>

<p>Here is a full example of generating the above JSON header in a Perl script:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="err">#</span><span class="o">!</span><span class="err">/usr/bin/perl</span>
</span><span class='line'><span class="nx">use</span> <span class="nx">strict</span><span class="p">;</span>
</span><span class='line'><span class="nx">use</span> <span class="nx">JSON</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">my</span> <span class="nx">$header</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">to</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;ben@sendgrid.com&#39;</span><span class="p">,</span> <span class="s1">&#39;joe@sendgrid.com],</span>
</span><span class='line'><span class="s1">sub =&gt; { &#39;</span><span class="o">%</span><span class="nx">name</span><span class="o">%</span><span class="s1">&#39; =&gt; [ &#39;</span><span class="nx">Ben</span><span class="s1">&#39;, &#39;</span><span class="nx">Joe</span><span class="s1">&#39; ], &#39;</span><span class="o">%</span><span class="nx">role</span><span class="o">%</span><span class="s1">&#39; =&gt;; [ &#39;</span><span class="nx">sellerSection</span><span class="s1">&#39;, &#39;</span><span class="nx">buyerSection</span><span class="s1">&#39; ] },</span>
</span><span class='line'><span class="s1">section =&gt; { &#39;</span><span class="o">%</span><span class="nx">sellerSection</span><span class="o">%</span><span class="s1">&#39; =&gt;; &#39;</span><span class="nx">Seller</span> <span class="nx">information</span> <span class="k">for</span><span class="o">:</span> <span class="o">%</span><span class="nx">name</span><span class="o">%</span><span class="s1">&#39;, &#39;</span><span class="o">%</span><span class="nx">buyerSection</span><span class="o">%</span><span class="s1">&#39; =&gt; &#39;</span><span class="nx">Buyer</span> <span class="nx">information</span> <span class="k">for</span><span class="o">:</span> <span class="o">%</span><span class="nx">name</span><span class="o">%</span><span class="s1">&#39; },</span>
</span><span class='line'><span class="s1">category =&gt; &#39;</span><span class="nx">Orders</span><span class="s1">&#39;,</span>
</span><span class='line'><span class="s1">unique_args =&gt; { &#39;</span><span class="nx">orderNumber</span><span class="s1">&#39; =&gt; &#39;</span><span class="mi">12345</span><span class="s1">&#39;, &#39;</span><span class="nx">eventID</span><span class="s1">&#39; =&gt; &#39;</span><span class="mi">6789</span><span class="s1">&#39; },</span>
</span><span class='line'><span class="s1">filters =&gt; { &#39;</span><span class="nx">footer</span><span class="s1">&#39; =&gt; {&#39;</span><span class="nx">settings</span><span class="s1">&#39; =&gt; {&#39;</span><span class="nx">text</span><span class="o">/</span><span class="nx">plain</span><span class="err">&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Thank you for your business&quot;</span><span class="p">}}}};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">my</span> <span class="nx">$json</span> <span class="o">=</span> <span class="nx">JSON</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">;</span>
</span><span class='line'><span class="nx">$json</span><span class="o">-&gt;</span><span class="nx">space_before</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="nx">$json</span><span class="o">-&gt;</span><span class="nx">space_after</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="nx">my</span> <span class="nx">$js</span> <span class="o">=</span> <span class="nx">$json</span><span class="o">-&gt;</span><span class="nx">encode</span><span class="p">(</span><span class="nx">$header</span><span class="p">);</span>
</span><span class='line'><span class="err">#</span> <span class="nx">This</span> <span class="nx">regex</span> <span class="nx">breaks</span> <span class="nx">the</span> <span class="nx">string</span> <span class="nx">up</span> <span class="nx">at</span> <span class="nx">whitespaces</span> <span class="nx">to</span> <span class="nx">keep</span> <span class="nx">the</span> <span class="nx">line</span> <span class="nx">length</span> <span class="kr">short</span>
</span><span class='line'><span class="nx">$js</span> <span class="o">=~</span> <span class="nx">s</span><span class="o">/</span><span class="p">(.{</span><span class="mi">1</span><span class="p">,</span><span class="mi">72</span><span class="p">})(</span><span class="err">\</span><span class="nx">s</span><span class="p">)</span><span class="o">/</span><span class="nx">$1</span><span class="err">\</span><span class="nx">n</span><span class="err">   </span><span class="o">/</span><span class="nx">g</span><span class="p">;</span>
</span><span class='line'><span class="nx">my</span> <span class="nx">$hdr</span> <span class="o">=</span> <span class="s2">&quot;X-SMTPAPI: $js&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">print</span> <span class="s2">&quot;$hdr\n&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>

<h2>Requirements and Limitations</h2>

<p>When setting filters via SMTPAPI, all filter names and setting names must be lowercase.</p>

<p>If you use the multiple recipient functionality of the API, you must not send to multiple recipients with the SMTP protocol as well. Doing so can cause duplicates of the message to be sent.
</p>

<p>Ensure that the header is limited to a maximum total line length of 1,000 characters. Failure to do this can cause intermediate MTA&#8217;s to split the header for you on non-space boundaries, which will cause spaces to be inserted in the final resulting e-mail. In addition, if your e-mail is going through another MTA before reaching SendGrid, it is likely to have an even lower setting for maximum header length and may truncate the header.</p>

<p>When using the API, if our system encounters a parsing error, the message will be bounced to the address specified in the MAIL FROM portion of the SMTP session. The MAIL FROM address is re-written when we send e-mail out for final delivery, so it is safe to set this to an address that can receive the bounces so that you will be alerted on errors.</p>

<p>While there is no hard limit to the number of addresses that can be sent to in a multiple recipient e-mail, it is best to split up large jobs at around 1,000 recipients, as this will better allow for the processing load to be distributed.</p>

<p>For substitution tags, it is best to avoid characters that have special meaning in html, such as &lt;,&gt;, and &. These might end up encoded and will not be properly substituted.</p>







  
    <footer>
      
      
        <div class="sharing">
  
  
  
</div>

      
      
    </footer>
  
</article>


    </div>
  </div>
	<div id="footer">
	<div class="container-fluid footer-links">
	<div class="container">
		<div class="row">
			<div class="span2">
				<h4>Sales</h4>
				<a href="http://sendgrid.com/pricing/">Pricing</a><br/>
				<a href="http://sendgrid.com/features/">Features</a>
			</div>
			<div class="span2">
				<h4>Support</h4>
				<a href="http://support.sendgrid.com/">Contact Support</a><br/>
				<a href="http://docs.sendgrid.com/">Documentation</a><br/>
				<a href="http://sendgrid.com/contact/reportSpam">Report Spam</a>
			</div>
			<div class="span2">
				<h4>Community</h4>
				<a href="http://twitter.com/sendgrid/">Twitter</a><br/>
				<a href="http://community.sendgrid.com/">Forum</a>
			</div>
			<div class="span2">
				<h4>Company</h4>
				<a href="http://http://sendgrid.com/about.html">About</a><br/>
				<a href="http://sendgrid.com/team.html">Our Team</a><br/>
				<a href="http://sendgrid.com/jobs.html">Jobs</a><br/>
				<a href="http://sendgrid.com/press.html">Press</a><br/>
				<a href="http://sendgrid.com/contact.html">Contact Us</a>
			</div>
			<div class="span2">
				<h4>Connect With Us!</h4>
				<a href="http://blog.sendgrid.com/feed/"><img alt="RSS" title="Feed" src="/images/rss.gif"></a> 
		          <a href="http://twitter.com/SendGrid"><img alt="Twitter" title="Twitter" src="/images/twitter.gif"></a> 
		          <a href="http://www.facebook.com/SendGrid"><img alt="Facebook" title="Facebook" src="/images/facebook.gif"></a>

			</div>
		</div>
	</div>
	</div>

	<footer id="bottom-footer">
	<div class="container">
		<div class="row">
			<div class="span5">
	        	<p>&copy; SendGrid 2012</p>
			</div>

			<div class="span7">
				<a href="http://sendgrid.com/tos.html">Terms of Service</a>

				<a href="http://sendgrid.com/tos.html">Email Policy</a>

				<a href="http://sendgrid.com/tos.html">Privacy Policy</a>

				<p class="pull-right"><a href="#">Back to top</a></p>
			</div>
		</div>
	</div> <!-- /container -->
	</footer>
</div>

	<!-- 







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




-->
</body>
</html>
