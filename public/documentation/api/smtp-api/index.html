
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>SMTP API - My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="SMTP API Apr 12th, 2011 NOTE >> If you&#8217;re enabling an App, also called a filter, via SMTP-API, you are required to define all the parameters &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yoursite.com/documentation/api/smtp-api">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/bootstrap/bootstrap.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/bootstrap/responsive.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <style type="text/css">
    body {
      padding-bottom: 40px;
    }
    h1 {
      margin-bottom: 15px;
    }
    img {
      max-width: 100%;
    }
    .sharing, .meta, .pager {
      margin: 20px 0px 20px 0px;
    }
    .page-footer p {
      text-align: center;
    }
  </style>
  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  
  

</head>

<body   >
  <nav role="navigation"><div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <a class="brand" href="/">My Octopress Blog</a>

      <div class="nav-collapse">
        <ul class="nav">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


        <ul class="nav pull-right" data-subscription="rss">
          <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
          
        </ul>

        
          <form class="pull-right navbar-search" action="http://google.com/search" method="get">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:yoursite.com" />
              <input class="search-query" type="text" name="q" results="0" placeholder="Search"/>
            </fieldset>
          </form>
        
      </div>
    </div>
  </div>
</div>
</nav>
  <div class="container">
    <div class="row-fluid">
      
<article role="article" class="span9">

  
  <header class="page-header">
    <h1 class="entry-title">SMTP API</h1>
    <p class="meta">








  


<time datetime="2011-04-12T07:15:48-06:00" pubdate data-updated="true">Apr 12<span>th</span>, 2011</time></p>
  </header>
  
  <blockquote><p><strong>NOTE >> </strong>If you&#8217;re enabling an App, also called a filter, via SMTP-API, <a href="http://docs.sendgrid.com/documentation/api/smtp-api/filter-settings/">you are required to define all the parameters for the App</a>. If you have the App disabled on the web interface, our system will not pull the settings for the disabled app when you dynamically enable it. For instance, if you have a template designed but disabled, you can&#8217;t just enable it via the API; you need to define the template in the API call itself.</p></blockquote>

<p>SendGrid&#8217;s <strong>SMTP API</strong> allows developers to deliver custom handling instructions for e-mail. This is accomplished through a header, X-SMTPAPI, that is inserted into the message. The header is a JSON encoded list of instructions and options for that email. An example header looks like this:</p>

<p><code>X-SMTPAPI: {"category" : "newuser"}</code></p>

<p>In this case, the header is telling the processing routine to assign this email the <a href="/documentation/delivery-metrics/categories/">category</a> of &#8220;newuser&#8221;.</p>

<p>For a complete description of the X-SMTPAPI JSON header and what each value does, please see theÂ <a href="/documentation/api/smtp-api/developers-guide/">Developer&#8217;s Guide</a>.</p>

<p>SendGrid provides libraries to build this header in the following languages:</p>

<ul>
<li><p><a href="/documentation/api/smtp-api/perl-example/">Perl</a></p></li>
<li><p><a href="/documentation/api/smtp-api/php-example/">PHP</a></p></li>
<li><p><a href="/documentation/api/smtp-api/python-example/">Python</a></p></li>
<li><p><a href="/documentation/api/smtp-api/ruby-example/">Ruby</a></p></li>
</ul>


<blockquote><p><strong>TIP >> </strong>If your language is not listed, try the <a href="/documentation/api/smtp-api/developers-guide/">Developer&#8217;s Guide</a>.</p></blockquote>

<p>Each of the classes provided support the following functions:</p>

<ul>
<li><p><strong>addTo(to)</strong> - Provide either a single recipient or a list of recipients. Using this function, it is possible to send one e-mail from your system that will be delivered to many addresses.</p></li>
<li><p><strong>AddSubVal(var,val)</strong> - Specify substitution variables for multi recipient e-mails. This would allow you to, for example, substitute the string with a recipient&#8217;s name. &#8216;val&#8217; can be either a scalar or an array. It is the user&#8217;s responsibility to ensure that there are an equal number of substitution values as there are recipients</p></li>
<li><p><strong>setUniqueArgs(val)</strong> - Specify any unique argument values</p></li>
<li><p><strong>setCategory(cat)</strong> - Sets a category for an e-mail to be logged as. You may use any category name you like. You are allowed to set up to 10 categories under this field as a standard array.</p></li>
<li><p><strong>addFilterSetting(filter,setting,val)</strong> - Adds/changes a setting for a filter. Settings specified in the header will override configured settings.</p></li>
<li><p><strong>asJSON()</strong> - Returns the JSON version of the requested data.</p></li>
<li><p><strong>as_string</strong> - Returns the full header which can be inserted into an e-mail.</p></li>
</ul>


<blockquote><p><strong>NOTE >> </strong>The reference to &#8216;filter&#8217; in the addFilterSetting class is an internal name for our Apps.</p>

<p><strong>WARNING >> </strong>If you use the multiple recipient functionality of the API, you must not send to multiple recipients with the SMTP protocol as well. Doing so can cause duplicates of the message to be sent.</p>

<p><strong>WARNING >> </strong>Ensure that the header is limited to a maximum total line length of 1,000 characters. Failure to do this can cause intermediate MTA&#8217;s to split the header for you on non-space boundaries, which will cause spaces to be inserted in the final resulting e-mail. In addition, if your e-mail is going through another MTA before reaching SendGrid, it is likely to have an even lower setting for maximum header length and may truncate the header.</p></blockquote>

<p>When using the API, if our system encounters a parsing error, the message will be bounced to the address specified in the MAIL FROM portion of the SMTP session. The MAIL FROM address is re-written when we send e-mail out for final delivery, so it is safe to set this to an address that can receive the bounces so that you will be alerted on errors.</p>

<p>While there is no hard limit to the number of addresses that can be sent to in a multiple recipient e-mail, it is best to split up large jobs at around 1,000 recipients, as this will better allow for the processing load to be distributed.</p>

<p>For substitution tags, it is best to avoid characters that have special meaning in html, such as &lt;,>, and &amp;. These might end up encoded and will not be properly substituted.</p>

<h3>Related Articles:</h3>

<ul>
<li><p><a href="/documentation/delivery-metrics/categories/">Categories</a></p></li>
<li><p><a href="/documentation/api/smtp-api/perl-example/">Perl Example</a></p></li>
<li><p><a href="/documentation/api/smtp-api/php-example/">PHP Example</a></p></li>
<li><p><a href="/documentation/api/smtp-api/python-example/">Python Example</a></p></li>
<li><p><a href="/documentation/api/smtp-api/ruby-example/">Ruby Example</a></p></li>
<li><p><a href="/documentation/api/smtp-api/developers-guide/">Developers Guide</a></p></li>
</ul>


  
    <footer>
      <p class="meta">
        
        








  


<time datetime="2011-04-12T07:15:48-06:00" pubdate data-updated="true">Apr 12<span>th</span>, 2011</time>
        
      </p>
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://yoursite.com/documentation/api/smtp-api/index.html" data-via="" data-counturl="http://yoursite.com/documentation/api/smtp-api/index.html" >Tweet</a>
  
  
  
</div>

      
      
    </footer>
  
</article>

<aside class="sidebar-nav span3">
  
    <section class="well">
  <ul id="recent_posts" class="nav nav-list">
    <li class="nav-header">Recent Posts</li>
    
      <li class="post">
        <a href="/blog/2011/10/06/valid-passwords/">Valid Passwords</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/07/27/billing-error-code/">Billing Error Code</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/06/27/how-to-eliminate-the-on-behalf-of-message/">How To: Eliminate the On Behalf Of Message</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/06/27/spf-records-dont-have-more-than-10-dns-lookups/">SPF Records:  Don't have more than 10 DNS lookups!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/06/21/what-is-throttling/">What is Throttling?</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo" class="page-footer"><hr>
<p>
  Copyright &copy; 2012 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
